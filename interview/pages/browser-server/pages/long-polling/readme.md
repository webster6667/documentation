# long-polling
![illustration](img/illustration.jpeg)
üëÜüèΩ –¢–µ—Ö–Ω–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞, –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

<details>
<summary> üí† –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã </summary>

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-up.svg)

üéØ –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä

<details>
<summary> ü•è –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å—Ç–æ–∏—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª (PHP)</summary>

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-up.svg)

&emsp;&emsp; üéØ –¶–∏–∫–ª —Ä–∞–∑ –≤ `n` —Å–µ–∫—É–Ω–¥, –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ –±–∞–∑—É, –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –∫–æ–ª–ª–∏—á–µ—Å—Ç–≤–∞ –Ω—É–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

&emsp;&emsp; üéØ –ï—Å–ª–∏ —á–µ—Ä–µ–∑ `n` —Å–µ–∫—É–Ω–¥, –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–∞–∫ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∑–∞–ø—Ä–æ—Å –Ω–∏—á–µ–≥–æ –Ω–µ –≤–µ—Ä–Ω–µ—Ç, –∏ –æ—Ç–≤–∞–ª–∏—Ç—å—Å—è –ø–æ —Ç–∞–π–º–∞—É—Ç—É  
&emsp;&emsp;&emsp;&emsp; üëÜ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è `long polling` –∑–∞–ø—Ä–æ—Å–∞, –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-down.svg)

</details>

<details>
<summary> ü•è –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å—Ç–æ–∏—Ç —Å–ª—É—à–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏–π</summary>

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-up.svg)

&emsp;&emsp; üéØ –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω–µ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª—É—à–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö  

&emsp;&emsp; üéØ –ï—Å–ª–∏ —á–µ—Ä–µ–∑ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å—Å—è, —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –∏ –∑–∞–ø—Ä–æ—Å –æ—Ç–≤–∞–ª–∏—Ç—å—Å—è –ø–æ —Ç–∞–π–º–∞—É—Ç—É

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-down.svg)

</details>    
    

üéØ –ü–æ—Å–ª–µ –æ—à–∏–±–∫–∏ –ø–æ —Ç–∞–π–º—É—Ç—É, –≤ `catch` –∫–æ–ª–±–µ–∫–µ –¥–ª–∏–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–µ—Ç—å—Å—è –µ—â–µ —Ä–∞–∑  
üéØ –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å, –º–µ—Ç–æ–¥ –±–µ–∫–µ–Ω–¥–∞ –≤–µ—Ä–Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ  
üéØ –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –¥–ª–∏–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö   
üéØ –≠—Ç–æ—Ç —Ü–∏–∫–ª –º–æ–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –µ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞  

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-down.svg)

</details>

<details>
<summary><img src="https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/ts.svg" height="20px" title="ts" >&emsp; –ö–ª–∏–µ–Ω—Ç</summary>

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-up.svg)

```typescript jsx
function App() {
    const [messages, setMessages] = useState([]);
    const [value, setValue] = useState('');


    // üëâüèº –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–Ω–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—á–∫–∏
    useEffect(() => {
        subscribe()
    }, [])

    // üëâüèº –®–ª–µ—Ç long-polling –∑–∞–ø—Ä–æ—Å—ã  
    const subscribe = async () => {
        try {
            const {data} = await axios.get(`${API_URL}/get-messages`)
            setMessages(prev => [data, ...prev])
            await subscribe()
        } catch (e) {
            setTimeout(() => {
                subscribe()
            }, 500)
        }
    }

    // üëâüèº –®–ª–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    const sendMessage = async () => {
        await axios.post(`${API_URL}/new-messages`, {
            message: value,
            id: Date.now()
        })
    }

  return (
      <div className="center">
          <div>
              <div className="form">
                  <input value={value} onChange={e => setValue(e.target.value)} type="text"/>
                  <button onClick={sendMessage}>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
              </div>
              <div className="messages">
                  {messages.map(mess =>
                      <div className="message" key={mess.id}>
                          {mess.message}
                      </div>
                  )}
              </div>
          </div>
      </div>
  )
}

```

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-down.svg)

</details>

<details>
<summary><img src="https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/ts.svg" height="20px" title="ts" >&emsp; –°–µ—Ä–≤–µ—Ä</summary>

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-up.svg)

```typescript
const express = require('express');
const cors = require('cors');
const events = require('events')
const PORT = 5080;

const emitter = new events.EventEmitter();

const app = express()

app.use(cors())
app.use(express.json())

app.get('/get-messages', (req, res) => {
    emitter.once('newMessage', (message) => {
        res.json(message)
    })
})

app.post('/new-messages', ((req, res) => {
    const message = req.body;
    emitter.emit('newMessage', message)
    res.status(200)
}))


app.listen(PORT, () => console.log(`server started on port ${PORT}`))
```

![illustration](https://raw.githubusercontent.com/webster6667/documentation/master/documentation-data/illustrations/dd-down.svg)

</details>

[![Edit custom-bind](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/p/github/webster-doc/long-polling-demo/master?layout=%257B%2522sidebarPanel%2522%253A%2522EXPLORER%2522%252C%2522rootPanelGroup%2522%253A%257B%2522direction%2522%253A%2522horizontal%2522%252C%2522contentType%2522%253A%2522UNKNOWN%2522%252C%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522id%2522%253A%2522ROOT_LAYOUT%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522UNKNOWN%2522%252C%2522direction%2522%253A%2522vertical%2522%252C%2522id%2522%253A%2522clomyrji800073b6i77rqrfhq%2522%252C%2522sizes%2522%253A%255B70%252C30%255D%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522EDITOR%2522%252C%2522direction%2522%253A%2522horizontal%2522%252C%2522id%2522%253A%2522EDITOR%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522EDITOR%2522%252C%2522id%2522%253A%2522clomyrji800033b6i0tnz6415%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%252C%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522SHELLS%2522%252C%2522direction%2522%253A%2522horizontal%2522%252C%2522id%2522%253A%2522SHELLS%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522SHELLS%2522%252C%2522id%2522%253A%2522clomyrji800053b6i6mh3imhw%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%255D%257D%252C%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522DEVTOOLS%2522%252C%2522direction%2522%253A%2522vertical%2522%252C%2522id%2522%253A%2522DEVTOOLS%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522DEVTOOLS%2522%252C%2522id%2522%253A%2522clomyrji800063b6i3e475jei%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%255D%252C%2522sizes%2522%253A%255B40%252C60%255D%257D%252C%2522tabbedPanels%2522%253A%257B%2522clomyrji800033b6i0tnz6415%2522%253A%257B%2522id%2522%253A%2522clomyrji800033b6i0tnz6415%2522%252C%2522tabs%2522%253A%255B%255D%257D%252C%2522clomyrji800063b6i3e475jei%2522%253A%257B%2522id%2522%253A%2522clomyrji800063b6i3e475jei%2522%252C%2522activeTabId%2522%253A%2522clomyvggj00t63b6ir3lk66j6%2522%252C%2522tabs%2522%253A%255B%257B%2522type%2522%253A%2522UNASSIGNED_PORT%2522%252C%2522port%2522%253A5080%252C%2522id%2522%253A%2522clomysyvt00ft3b6imrbniat1%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522path%2522%253A%2522%2522%257D%252C%257B%2522type%2522%253A%2522UNASSIGNED_PORT%2522%252C%2522port%2522%253A3000%252C%2522id%2522%253A%2522clomyvggj00t63b6ir3lk66j6%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522path%2522%253A%2522%252F%2522%257D%255D%257D%252C%2522clomyrji800053b6i6mh3imhw%2522%253A%257B%2522id%2522%253A%2522clomyrji800053b6i6mh3imhw%2522%252C%2522activeTabId%2522%253A%2522clomyt4na00hf3b6i8ubbhtot%2522%252C%2522tabs%2522%253A%255B%257B%2522id%2522%253A%2522clomyrji800043b6im435tnsg%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522type%2522%253A%2522TERMINAL%2522%252C%2522shellId%2522%253A%2522clomyrjqa000heehuhq96bcnu%2522%257D%252C%257B%2522id%2522%253A%2522clomyt4na00hf3b6i8ubbhtot%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522type%2522%253A%2522TERMINAL%2522%252C%2522shellId%2522%253A%2522clomyt4s5000jeehu3x4a82io%2522%257D%255D%257D%257D%252C%2522showDevtools%2522%253Atrue%252C%2522showShells%2522%253Atrue%252C%2522showSidebar%2522%253Atrue%252C%2522sidebarPanelSize%2522%253A15%257D)


<br>

### ‚üµ **<a href="../../readme.md">–ù–∞–∑–∞–¥</a>**